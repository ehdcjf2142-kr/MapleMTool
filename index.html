<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>메이플스토리M 과금 효율 분석기 | 조동이형 공식 도구</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #fdfaf6; color: #4a4a4a; scroll-behavior: smooth; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: 0 auto; height: 300px; }
        .active-tier { background-color: #fff7ed; border-color: #d97706; color: #d97706; }
        .loading-spinner { border: 3px solid #f3f3f3; border-top: 3px solid #d97706; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #privacy-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 100; align-items: center; justify-content: center; padding: 20px; }
        #privacy-modal.active { display: flex; }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 12px; }
    </style>
</head>
<body class="antialiased">

    <!-- Navigation -->
    <nav class="bg-white border-b border-gray-200 px-4 py-4 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <span class="text-2xl font-bold text-gray-800">🍁 메이플M <span class="text-orange-600">AI 분석기</span></span>
            <div class="space-x-4 hidden md:flex text-sm font-medium">
                <a href="#calculator" class="hover:text-orange-600">계산기</a>
                <a href="#ai-advisor" class="hover:text-orange-600">AI 질문</a>
                <a href="#featured-video" class="hover:text-orange-600">추천영상</a>
                <a href="#pro-tips" class="hover:text-orange-600">전문가 공략</a>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-4 py-8 space-y-12">
        
        <!-- Calculator Section -->
        <section id="calculator" class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">💸 과금 구간별 메소 시뮬레이션</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <button onclick="updateTier('low')" id="btn-low" class="p-4 rounded-xl border-2 text-left active-tier transition-all">
                    <div class="text-xs font-bold text-gray-400">소과금</div>
                    <div class="text-xl font-bold">~5.5만원</div>
                </button>
                <button onclick="updateTier('mid')" id="btn-mid" class="p-4 rounded-xl border-2 border-gray-100 text-left transition-all">
                    <div class="text-xs font-bold text-gray-400">중과금</div>
                    <div class="text-xl font-bold">~30만원</div>
                </button>
                <button onclick="updateTier('high')" id="btn-high" class="p-4 rounded-xl border-2 border-gray-100 text-left transition-all">
                    <div class="text-xs font-bold text-gray-400">고과금</div>
                    <div class="text-xl font-bold">~100만원</div>
                </button>
                <button onclick="updateTier('whale')" id="btn-whale" class="p-4 rounded-xl border-2 border-gray-100 text-left transition-all">
                    <div class="text-xs font-bold text-gray-400">초고과금</div>
                    <div class="text-xl font-bold">300만원+</div>
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 space-y-4">
                    <div class="bg-orange-50 rounded-xl p-6 border border-orange-100 text-center">
                        <p class="text-sm text-orange-800 font-bold mb-1">예상 획득량 (1주)</p>
                        <div class="flex items-baseline justify-center space-x-1">
                            <span id="meso-display" class="text-4xl font-bold text-orange-600">18</span>
                            <span class="text-lg text-orange-500 font-bold">억 메소</span>
                        </div>
                    </div>
                    <div class="p-4 bg-gray-50 rounded-xl border border-gray-100">
                        <h4 class="font-bold text-sm text-gray-700 mb-2">핵심 패키지 구성</h4>
                        <ul id="pkg-list" class="text-sm text-gray-600 space-y-2"></ul>
                    </div>
                </div>
                <div class="lg:col-span-2">
                    <div class="chart-container">
                        <canvas id="mesoChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gemini AI Advisor Section -->
        <section id="ai-advisor" class="bg-white rounded-2xl shadow-sm border border-orange-200 p-6 md:p-8">
            <div class="flex items-center space-x-2 mb-4">
                <span class="text-2xl">🤖</span>
                <h2 class="text-2xl font-bold text-gray-800">조동이 AI 어드바이저</h2>
            </div>
            <div class="flex flex-col md:flex-row gap-2">
                <input type="text" id="ai-input" placeholder="예: 현재 로얄 스타일 시세 어때?" 
                       class="flex-1 p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 outline-none">
                <button onclick="askGemini()" id="ask-btn" class="bg-orange-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-orange-700 flex items-center justify-center space-x-2 transition-all">
                    <span>분석하기</span>
                    <div id="loading" class="loading-spinner hidden"></div>
                </button>
            </div>
            <div id="ai-response-container" class="hidden mt-6 p-6 bg-orange-50 rounded-2xl border border-orange-100">
                <div id="ai-response" class="text-sm leading-relaxed text-gray-700 whitespace-pre-wrap"></div>
                <div id="grounding-sources" class="mt-4 pt-4 border-t border-orange-200 text-xs text-gray-400"></div>
            </div>
        </section>

        <!-- YouTube Embed Section -->
        <section id="featured-video" class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8">
            <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                <span class="text-red-600 mr-2">▶</span> 볼만한 조동이형 유튜브
            </h2>
            <div class="max-w-3xl mx-auto">
                <div class="video-container">
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/4fDNM-65dDA?si=9zSVEGUzgJLgF8cD" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
                <p class="mt-4 text-center text-gray-600 text-sm italic font-medium">"재밌는거 많습니다 보러 오세요~"</p>
            </div>
        </section>

        <!-- Pro Tips Section -->
        <section id="pro-tips" class="space-y-8">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-gray-800">🍁 메이플스토리M 메소 수급 공략</h2>
                <p class="text-gray-500 mt-2 text-lg">기념비적인 첫 합작품: 조동이형 X 쩸쓰</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm hover:border-orange-200 transition-colors">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">1. 왜 1주일 내 정산인가?</h3>
                    <p class="text-gray-600 text-sm leading-relaxed">메이플스토리M은 거래소 정산 대기 시간과 아이템 판매 기간이 존재합니다. 특히 고가 아이템은 매물이 소화되는 데 시간이 걸립니다. 본 분석기는 '현금을 지르고 1주일 내에 내 손에 메소를 쥐는 것'을 목표로 구성되었습니다.</p>
                </div>
                <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm hover:border-orange-200 transition-colors">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">2. 패키지 효율 순위</h3>
                    <p class="text-gray-600 text-sm leading-relaxed">가장 효율이 좋은 것은 단연 성장 패키지입니다. 그 다음으로는 월간/주간 단위로 판매되는 이벤트 패키지들이 일반 크리스탈 충전보다 약 2~3배 이상의 효율을 보입니다. 깡 크리스탈 충전은 최후의 수단입니다.</p>
                </div>
                <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm hover:border-orange-200 transition-colors">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">3. 로얄 스타일 vs 골드애플</h3>
                    <p class="text-gray-600 text-sm leading-relaxed">안정적인 수익을 원한다면 로얄 스타일을 추천합니다. 세트 효과가 있는 부위는 꾸준한 수요가 있습니다. 반면 골드애플은 일종의 로또입니다. 고가의 위대한 소울이나 희귀 장비가 뜨면 대박이지만, 기대값의 편차가 큽니다.</p>
                </div>
                <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm hover:border-orange-200 transition-colors">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">4. 거래소 수수료 아끼는 법</h3>
                    <p class="text-gray-600 text-sm leading-relaxed">메소 정산 시 가장 아까운 것이 10%의 수수료입니다. 패키지에 포함된 수수료 우대권이나 멤버십 혜택을 반드시 확인하세요. 수백억 메소를 거래할 때 5% 차이는 현금 몇 만 원 이상의 가치가 있습니다.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-100 py-12 border-t border-gray-200 mt-12">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <p class="text-gray-800 font-bold mb-4 text-lg underline decoration-orange-400">조동이형 공식 채널 도구</p>
            <div class="flex flex-wrap justify-center gap-6 text-sm font-medium mb-8">
                <a href="https://www.youtube.com/@JodongBroFullVideo" target="_blank" class="flex items-center text-red-600 hover:scale-110 transition-transform">
                    <span class="mr-1">📺</span> 조동이형의 유튜브
                </a>
                <a href="https://blog.naver.com/gamelifeequation" target="_blank" class="flex items-center text-green-600 hover:scale-110 transition-transform">
                    <span class="mr-1">📝</span> 조동이형의 블로그
                </a>
                <button onclick="toggleModal(true)" class="text-gray-500 hover:text-gray-800 transition-colors">개인정보처리방침</button>
            </div>
            <p class="text-xs text-gray-400 font-medium">© 2026 JodongBro X Jemss. First Edition.</p>
        </div>
    </footer>

    <!-- Privacy Policy Modal -->
    <div id="privacy-modal">
        <div class="bg-white rounded-2xl p-6 md:p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto relative shadow-2xl">
            <button onclick="toggleModal(false)" class="absolute top-4 right-4 text-2xl text-gray-400 hover:text-gray-600">&times;</button>
            <h2 class="text-2xl font-bold mb-4">개인정보처리방침</h2>
            <div class="text-sm text-gray-600 space-y-4 leading-relaxed">
                <p>본 사이트는 구글 애드센스 광고를 송출하며, 관심사 기반 광고를 위해 쿠키를 사용할 수 있습니다. 어떠한 개인식별 정보도 직접 수집하거나 서버에 저장하지 않습니다.</p>
            </div>
            <button onclick="toggleModal(false)" class="mt-8 w-full bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition-colors">확인</button>
        </div>
    </div>

    <script>
        // --- Core Data & UI Logic ---
        const tiers = {
            low: { meso: 18, pkgs: ["성장 패키지", "매일매일 크리스탈", "수수료 우대권"] },
            mid: { meso: 85, pkgs: ["활성 패키지 I", "위클리 이벤트", "성장 패키지 II"] },
            high: { meso: 240, pkgs: ["1+1 크리스탈 충전", "고급 뽑기권", "시즌 패키지"] },
            whale: { meso: 600, pkgs: ["상점 올매수", "깡 크리스탈 무제한", "마벨 저격"] }
        };

        let chart;
        function initChart() {
            const ctx = document.getElementById('mesoChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['소과금', '중과금', '고과금', '초고과금'],
                    datasets: [{
                        label: '예상 메소(억)',
                        data: [18, 85, 240, 600],
                        backgroundColor: 'rgba(217, 119, 6, 0.4)',
                        borderColor: '#d97706',
                        borderWidth: 1,
                        borderRadius: 8
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });
        }

        function updateTier(key) {
            const t = tiers[key];
            document.getElementById('meso-display').innerText = t.meso;
            document.getElementById('pkg-list').innerHTML = t.pkgs.map(p => `<li>✅ ${p}</li>`).join('');
            document.querySelectorAll('button').forEach(b => b.classList.remove('active-tier'));
            document.getElementById(`btn-${key}`).classList.add('active-tier');
            const idx = Object.keys(tiers).indexOf(key);
            chart.data.datasets[0].backgroundColor = chart.data.labels.map((_, i) => i === idx ? '#d97706' : 'rgba(217, 119, 6, 0.4)');
            chart.update();
        }

        function toggleModal(show) { document.getElementById('privacy-modal').classList.toggle('active', show); }

        // --- Gemini API Logic ---
        const apiKey = ""; 
        async function fetchGemini(prompt) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: "너는 메이플M 전문가야. 구글 검색을 통해 최신 정보를 찾아 답변해. 5줄 이내로 요약해서 친절하게 말해줘." }] },
                tools: [{ "google_search": {} }]
            };
            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (response.ok) return await response.json();
                } catch (e) { await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000)); }
            }
        }

        async function askGemini() {
            const input = document.getElementById('ai-input').value;
            if (!input) return;
            const btn = document.getElementById('ask-btn');
            const loader = document.getElementById('loading');
            const resContainer = document.getElementById('ai-response-container');
            btn.disabled = true;
            loader.classList.remove('hidden');
            resContainer.classList.add('hidden');
            try {
                const result = await fetchGemini(input);
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                const sources = result.candidates?.[0]?.groundingMetadata?.groundingAttributions?.map(a => `<a href="${a.web?.uri}" target="_blank" class="mr-2 underline">${a.web?.title}</a>`).join('');
                document.getElementById('ai-response').innerText = text || "분석 실패";
                document.getElementById('grounding-sources').innerHTML = sources ? "참고: " + sources : "";
                resContainer.classList.remove('hidden');
            } finally {
                btn.disabled = false;
                loader.classList.add('hidden');
            }
        }
        window.onload = () => { initChart(); updateTier('low'); };
    </script>
</body>
</html>