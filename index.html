<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë©”ì´í”ŒìŠ¤í† ë¦¬M AI ê³¼ê¸ˆ ë¶„ì„ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #fdfaf6; color: #4a4a4a; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: 0 auto; height: 300px; }
        .active-tier { background-color: #fff7ed; border-color: #d97706; color: #d97706; }
        .loading-spinner { border: 3px solid #f3f3f3; border-top: 3px solid #d97706; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="antialiased">

    <nav class="bg-white border-b border-gray-200 px-4 py-4 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <span class="text-2xl font-bold text-gray-800">ğŸ ë©”ì´í”ŒM <span class="accent-text text-orange-600">AI ë¶„ì„ê¸°</span></span>
            <div class="text-sm text-gray-500">ì¡°ë™ì´í˜• ì±„ë„ ê³µì‹ ë„êµ¬</div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-4 py-8 space-y-12">
        <!-- 1. ê¸°ë³¸ ë¶„ì„ê¸° ì„¹ì…˜ -->
        <section class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8">
            <div class="mb-6">
                <h2 class="text-2xl font-bold mb-2 text-gray-800">ğŸ’¸ ê³¼ê¸ˆ êµ¬ê°„ë³„ ë©”ì†Œ ì‹œë®¬ë ˆì´ì…˜</h2>
                <p class="text-gray-600">êµ¬ê°„ì„ ì„ íƒí•˜ë©´ 1ì£¼ì¼ ë‚´ í™•ë³´ ê°€ëŠ¥í•œ ë©”ì†Œë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <button onclick="updateTier('low')" id="btn-low" class="p-4 rounded-xl border-2 text-left active-tier transition-all">
                    <div class="text-xs font-bold text-gray-400">ì†Œê³¼ê¸ˆ</div>
                    <div class="text-xl font-bold">~5.5ë§Œì›</div>
                </button>
                <button onclick="updateTier('mid')" id="btn-mid" class="p-4 rounded-xl border-2 border-gray-100 text-left transition-all">
                    <div class="text-xs font-bold text-gray-400">ì¤‘ê³¼ê¸ˆ</div>
                    <div class="text-xl font-bold">~30ë§Œì›</div>
                </button>
                <button onclick="updateTier('high')" id="btn-high" class="p-4 rounded-xl border-2 border-gray-100 text-left transition-all">
                    <div class="text-xs font-bold text-gray-400">ê³ ê³¼ê¸ˆ</div>
                    <div class="text-xl font-bold">~100ë§Œì›</div>
                </button>
                <button onclick="updateTier('whale')" id="btn-whale" class="p-4 rounded-xl border-2 border-gray-100 text-left transition-all">
                    <div class="text-xs font-bold text-gray-400">ì´ˆê³ ê³¼ê¸ˆ</div>
                    <div class="text-xl font-bold">300ë§Œì›+</div>
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 space-y-4">
                    <div class="bg-orange-50 rounded-xl p-6 border border-orange-100">
                        <p class="text-sm text-orange-800 font-bold mb-1">ì˜ˆìƒ íšë“ëŸ‰</p>
                        <div class="flex items-baseline space-x-1">
                            <span id="meso-display" class="text-4xl font-bold text-orange-600">18</span>
                            <span class="text-lg text-orange-500 font-bold">ì–µ ë©”ì†Œ</span>
                        </div>
                    </div>
                    <div class="p-4 bg-gray-50 rounded-xl border border-gray-100">
                        <h4 class="font-bold text-sm text-gray-700 mb-2">ì¶”ì²œ êµ¬ì„±</h4>
                        <ul id="pkg-list" class="text-sm text-gray-600 space-y-2"></ul>
                    </div>
                </div>
                <div class="lg:col-span-2">
                    <div class="chart-container">
                        <canvas id="mesoChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- 2. Gemini AI ì–´ë“œë°”ì´ì € ì„¹ì…˜ (ì¶”ê°€ëœ ê¸°ëŠ¥) -->
        <section class="bg-white rounded-2xl shadow-sm border border-orange-200 p-6 md:p-8">
            <div class="flex items-center space-x-2 mb-6">
                <span class="text-2xl">ğŸ¤–</span>
                <h2 class="text-2xl font-bold text-gray-800">Gemini AI ì „ìš© ì–´ë“œë°”ì´ì €</h2>
            </div>
            
            <div class="space-y-4">
                <p class="text-gray-600 text-sm">í˜„ì¬ ë©”ì´í”ŒM ìµœì‹  ì‹œì„¸ë‚˜ íŒ¨í‚¤ì§€ íš¨ìœ¨ì— ëŒ€í•´ AIì—ê²Œ ë¬¼ì–´ë³´ì„¸ìš”. (êµ¬ê¸€ ê²€ìƒ‰ ê¸°ë°˜)</p>
                <div class="flex flex-col md:flex-row gap-2">
                    <input type="text" id="ai-input" placeholder="ì˜ˆ: í˜„ì¬ ë¡œì–„ ìŠ¤íƒ€ì¼ ì‹œì„¸ê°€ ì–´ë•Œ? ë˜ëŠ” ì„±ì¥ íŒ¨í‚¤ì§€ íš¨ìœ¨ ë¶„ì„í•´ì¤˜" 
                           class="flex-1 p-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500">
                    <button onclick="askGemini()" id="ask-btn" class="bg-orange-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-orange-700 transition-colors flex items-center justify-center space-x-2">
                        <span>ì§ˆë¬¸í•˜ê¸°</span>
                        <div id="loading" class="loading-spinner hidden"></div>
                    </button>
                </div>
                
                <div id="ai-response-container" class="hidden mt-6 p-6 bg-orange-50 rounded-2xl border border-orange-100">
                    <div class="flex items-start space-x-3">
                        <span class="text-xl">ğŸ’¡</span>
                        <div id="ai-response" class="text-sm leading-relaxed text-gray-700 whitespace-pre-wrap"></div>
                    </div>
                    <div id="grounding-sources" class="mt-4 pt-4 border-t border-orange-200 text-xs text-gray-400"></div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // --- ê¸°ë³¸ ë°ì´í„° ë° ì‹œë®¬ë ˆì´í„° ë¡œì§ ---
        const tiers = {
            low: { meso: 18, pkgs: ["ì„±ì¥ íŒ¨í‚¤ì§€(ìºë¦­í„°)", "ë§¤ì¼ë§¤ì¼ í¬ë¦¬ìŠ¤íƒˆ", "ìˆ˜ìˆ˜ë£Œ ìš°ëŒ€ê¶Œ"] },
            mid: { meso: 85, pkgs: ["ì›”ê°„ í™œì„± íŒ¨í‚¤ì§€ I", "ìœ„í´ë¦¬ ì´ë²¤íŠ¸", "ì„±ì¥ íŒ¨í‚¤ì§€ II"] },
            high: { meso: 240, pkgs: ["1+1 í¬ë¦¬ìŠ¤íƒˆ íŒ¨í‚¤ì§€", "ê³ ê¸‰ ë½‘ê¸° ì„¸íŠ¸", "ì‹œì¦Œ í•œì • íŒ¨í‚¤ì§€"] },
            whale: { meso: 600, pkgs: ["ìƒì  ì˜¬ë§¤ìˆ˜", "ê¹¡ í¬ë¦¬ìŠ¤íƒˆ ì¶©ì „", "ë§ˆìŠ¤í„° ë¼ë²¨ ì €ê²©"] }
        };

        let chart;
        function initChart() {
            const ctx = document.getElementById('mesoChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ì†Œê³¼ê¸ˆ', 'ì¤‘ê³¼ê¸ˆ', 'ê³ ê³¼ê¸ˆ', 'ì´ˆê³ ê³¼ê¸ˆ'],
                    datasets: [{
                        label: 'ì˜ˆìƒ ë©”ì†Œ(ì–µ)',
                        data: [18, 85, 240, 600],
                        backgroundColor: 'rgba(217, 119, 6, 0.5)',
                        borderRadius: 8
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });
        }

        function updateTier(key) {
            const t = tiers[key];
            document.getElementById('meso-display').innerText = t.meso;
            document.getElementById('pkg-list').innerHTML = t.pkgs.map(p => `<li>âœ… ${p}</li>`).join('');
            document.querySelectorAll('button').forEach(b => b.classList.remove('active-tier'));
            document.getElementById(`btn-${key}`).classList.add('active-tier');
            
            const idx = Object.keys(tiers).indexOf(key);
            chart.data.datasets[0].backgroundColor = chart.data.labels.map((_, i) => i === idx ? '#d97706' : 'rgba(217, 119, 6, 0.5)');
            chart.update();
        }

        // --- Gemini API ë¡œì§ (LLM í˜¸ì¶œ) ---
        const apiKey = ""; // ì‹¤í–‰ í™˜ê²½ì—ì„œ ìë™ìœ¼ë¡œ ì œê³µë¨

        async function fetchGemini(prompt) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: "ë„ˆëŠ” ë©”ì´í”ŒìŠ¤í† ë¦¬M ê³¼ê¸ˆ ë° íš¨ìœ¨ ë¶„ì„ ì „ë¬¸ê°€ì•¼. êµ¬ê¸€ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìœ ì €ì˜ ì§ˆë¬¸ì— ì¹œì ˆí•˜ê²Œ ë‹µë³€í•´ì¤˜. ë‹µë³€ì€ 5ì¤„ ì´ë‚´ë¡œ ìš”ì•½í•´ì„œ í•œêµ­ì–´ë¡œ ë§í•´ì¤˜." }] },
                tools: [{ "google_search": {} }]
            };

            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) throw new Error('API Error');
                    return await response.json();
                } catch (e) {
                    await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
                }
            }
            throw new Error('ëª¨ë“  ì¬ì‹œë„ ì‹¤íŒ¨');
        }

        async function askGemini() {
            const input = document.getElementById('ai-input').value;
            if (!input) return;

            const btn = document.getElementById('ask-btn');
            const loader = document.getElementById('loading');
            const resContainer = document.getElementById('ai-response-container');
            const resText = document.getElementById('ai-response');
            const sourceText = document.getElementById('grounding-sources');

            btn.disabled = true;
            loader.classList.remove('hidden');
            resContainer.classList.add('hidden');

            try {
                const result = await fetchGemini(input);
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                const sources = result.candidates?.[0]?.groundingMetadata?.groundingAttributions?.map(a => `<a href="${a.web?.uri}" target="_blank" class="underline"> [${a.web?.title}] </a>`).join(' ');

                resText.innerText = text || "ë‹µë³€ì„ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                sourceText.innerHTML = sources ? "ì¶œì²˜: " + sources : "";
                resContainer.classList.remove('hidden');
            } catch (e) {
                resText.innerText = "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
                resContainer.classList.remove('hidden');
            } finally {
                btn.disabled = false;
                loader.classList.add('hidden');
            }
        }

        window.onload = () => { initChart(); updateTier('low'); };
    </script>
</body>
</html>